# CVE-2024-1303---Badgermeter-moni-tool-Path-Traversal
https://www.incibe.es/en/incibe-cert/notices/aviso-sci/multiple-vulnerabilities-badger-meters-monitool

CVE-2024-1303: 6.5 | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N | CWE-22.

**Software link**: https://www.s-can.at/en/product/monitool/

**Version**: 4.6.3

**@author**: Guillermo García Molina

**Description**: In s:can moni:tools up to and including version 4.6.3, an authenticated attacker could get any file from the device by path traversal in the download-file functionality.

## POC

The Download files functionality, found in (Service>Output>Export Data>Files), is used to download different documents from the application. When these documents are selected and the button “Download files” is pressed, a compressed file with the requested documents is downloaded:
 
![image](https://github.com/guillermogm4/CVE-2024-1303---Badgermeter-moni-tool-Path-Traversal/assets/26895345/21a65f6d-77a1-4926-9da9-d3e34cf2c92d)

The parameter names, which is found in the request performed to the server, is affected by a path traversal vulnerability. As it is shown in the following pictures, injecting the payload ../../../../../etc/passwd in the vulnerable parameter of the request performed to the export-autofiles-download.x endpoint, downloads a compressed file with /etc/passwd.
 
![image](https://github.com/guillermogm4/CVE-2024-1303---Badgermeter-moni-tool-Path-Traversal/assets/26895345/592aa68a-e420-4274-b25f-1ce8a54b34f6)

 
![image](https://github.com/guillermogm4/CVE-2024-1303---Badgermeter-moni-tool-Path-Traversal/assets/26895345/d93d29d1-f90c-4331-8346-7a6cf00b3851)

 
![image](https://github.com/guillermogm4/CVE-2024-1303---Badgermeter-moni-tool-Path-Traversal/assets/26895345/93fe0377-06d1-4e8f-b575-2e82e9ae6431)

 
![image](https://github.com/guillermogm4/CVE-2024-1303---Badgermeter-moni-tool-Path-Traversal/assets/26895345/3d3b0978-a6f6-4456-9ad6-29c8e7dfa830)

